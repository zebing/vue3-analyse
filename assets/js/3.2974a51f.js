(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{416:function(t,a,s){t.exports=s.p+"assets/img/1-2.08e54a68.jpeg"},417:function(t,a,s){t.exports=s.p+"assets/img/1-3.3bc4a323.png"},418:function(t,a,s){t.exports=s.p+"assets/img/1-4.751f4ef0.jpeg"},429:function(t,a,s){"use strict";s.r(a);var e=s(62),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"源码调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码调试"}},[t._v("#")]),t._v(" 源码调试")]),t._v(" "),e("p",[t._v("调试对于学习框架代码来说是一项非常重要的技能，掌握了调试的技巧就是成功的一半。它可以让你在阅读源码过程中产生的疑惑，轻松的解决。现在让我们开始了解如何调试 vue3 源码吧。")]),t._v(" "),e("h2",{attrs:{id:"获取源码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取源码"}},[t._v("#")]),t._v(" 获取源码")]),t._v(" "),e("p",[t._v("从 github 拉取代码")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone https://github.com/vuejs/core.git vue3\n")])])]),e("h2",{attrs:{id:"安装依赖"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖"}},[t._v("#")]),t._v(" 安装依赖")]),t._v(" "),e("p",[t._v("vue3 项目环境要求 Nodejs 版本 "),e("code",[t._v(">=14.19")]),t._v("，并使用 "),e("a",{attrs:{href:"https://pnpm.io/zh/installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("pnpm"),e("OutboundLink")],1),t._v(" 安装依赖。")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" vue3\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v("\n")])])]),e("h2",{attrs:{id:"启动服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动服务"}},[t._v("#")]),t._v(" 启动服务")]),t._v(" "),e("p",[t._v("启动服务需要打开两个终端窗口，分别运行两个命令。")]),t._v(" "),e("ol",[e("li",[t._v("运行 dev 命令，监控源码变动并实时更新 vue 目录下的 dist 文件。")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" run dev\n")])])]),e("ol",{attrs:{start:"2"}},[e("li",[t._v("运行 serve 命令，可以在浏览器访问 vue 目录下面的 examples 文件。")])]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("pnpm")]),t._v(" run serve\n")])])]),e("p",[t._v("在浏览其中输入 "),e("code",[t._v("http://localhost:5000/packages/vue/examples/")]),t._v("，可以看到如下页面。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(416),alt:"serve page"}})]),t._v(" "),e("p",[t._v("然后任意点击 classic，composition 或 transition 目录下的一个 html 文件，打开页面。这里我们点击 classic 目录下的 grid.html 文件。可以看到如下页面：")]),t._v(" "),e("p",[e("img",{attrs:{src:s(417),alt:"grid page"}})]),t._v(" "),e("h2",{attrs:{id:"开始调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开始调试"}},[t._v("#")]),t._v(" 开始调试")]),t._v(" "),e("p",[t._v("页面打开时候，接下来就可以开始调试源码了。你可以在源码的任何一个地方做一些改变，然后点击保存，然后刷新页面，这时就可以看到自己所做的变更了。")]),t._v(" "),e("p",[t._v("这里我们在 "),e("code",[t._v("packages/reactivity/src/reactive.ts")]),t._v(" 文件的 reactive 方法里面添加一个 console.log 打印出 target 信息。")]),t._v(" "),e("div",{staticClass:"language-javascript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-javascript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" reactive"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("object")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" UnwrapNestedRefs"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token constant"}},[t._v("T")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[e("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("target")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" object")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// if trying to observe a readonly proxy, return the readonly version.")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("isReadonly")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" target\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打印 target 信息")]),t._v("\n  console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'target'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("createReactiveObject")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    mutableHandlers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    mutableCollectionHandlers"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    reactiveMap\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("然后返回页面刷新，这时在调试界面就可以看到打印的 target 信息了。")]),t._v(" "),e("p",[e("img",{attrs:{src:s(418),alt:"target info"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);